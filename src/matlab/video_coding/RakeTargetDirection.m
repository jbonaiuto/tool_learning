positiontask.name = {'a';'b';'c';'d';'e';...
    '1';'2';'3';'4';'5';...
    '6';'7';'8';'9';'10';...
    '11';'12';'13';'14';'15';...
    '16';'17';'18';'19';'20';...
    '21';'22'};

positiontask.x = [.31;.39;.5;.61;.7;...
    .32;.35;.37;.42;.46;...
    .50;.55;.58;.63;.65;...
    .70;.23;.27;.32;.38;...
    .44;.50;.56;.63;.69;...
    .72;.77];

positiontask.y = [;.68;.60;.58;.60;.68;...
    .77;.73;.68;.67;.65;...
    .63;.65;.66;.68;.73;...
    .77;.73;.65;.59;.56;...
    .54;.52;.54;.57;.69;...
    .65;.73];

d = dir(['F:\Tool_project\coding_gctest\' '*.xlsx'])
%d = dir([C:\Users\kirchher\project\video_coding\Cube_trap_20190927_27-09-2019_SK.xlsx]);

direction = [];

for xlsx_idx = 1:length(d)
    dat = readtable([d(xlsx_idx).folder '\' d(xlsx_idx).name]);
    for dat_idx = 1:size(dat,1)
        for target_idx = 1:5
            for rake_idx = 1:27
                if strcmp(dat.RakeStarting(dat_idx),cell2mat(positiontask.name(rake_idx))) == 1 &...
                        strcmp(dat.TargetStarting(dat_idx),cell2mat(positiontask.name(target_idx))) == 1
                    p1 = positiontask.x(rake_idx)-.5;
                    p2 = positiontask.x(target_idx)-.5;
                    if (p2-p1) > 0
                        direction{dat_idx,xlsx_idx} = 'right';
                        %keyboard
                    end
                    if (p2-p1) < 0
                        direction{dat_idx,xlsx_idx} = 'left';
                        %keyboard
                    end
                    if (p2-p1) == 0
                        direction{dat_idx,xlsx_idx} = 'aligned';
                    end
                end
            end
        end
    end
end
%percentall = (sum(successmatrix,3)./sum(trialmatrix,3))*100